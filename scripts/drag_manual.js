!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.registerAframeClickDragComponent=e()}}(function(){return function e(t,n,o){function r(u,c){if(!n[u]){if(!t[u]){var a="function"==typeof require&&require;if(!c&&a)return a(u,!0);if(i)return i(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var d=n[u]={exports:{}};t[u][0].call(d.exports,function(e){var n=t[u][1][e];return r(n?n:e)},d,d.exports,e,t,n,o)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(e,t,n){"use strict";function o(e,t){return t={exports:{}},e(t,t.exports),t.exports}function r(e){var t,n,o=e.length;if(1===o)t=0,n=e[0][1];else{for(var r,i,u,c=0,a=0,f=0,d=0,l=0;l<o;l++)r=e[l],i=r[0],u=r[1],c+=i,a+=u,f+=i*i,d+=i*u;t=(o*d-c*a)/(o*f-c*c),n=a/o-t*c/o}return{m:t,b:n}}function i(e){return function(t){return e.b+e.m*t}}function u(e){for(var t=e;t.parent;)t=t.parent;t.updateMatrixWorld(!0)}function c(e,t){var n=e;for(t.set(n.components.position.data.x,n.components.position.data.y,n.components.position.data.z);n.attachedToParent;)n=n.parentElement,n.components&&n.components.position&&t.set(t.x+n.components.position.data.x,t.y+n.components.position.data.y,t.z+n.components.position.data.z)}function a(e,t,n){return u(t),t.localToWorld(n)}function f(e,t,n,o,r,i){return{x:(e-n)/r*2-1,y:2*-((t-o)/i)+1}}function d(e,t,n){var o=t/e.dot(n);return n.multiplyScalar(o)}function l(e,t,n,o,r,i,u){function c(i){var c=i.clientX,a=i.clientY;x={clientX:c,clientY:a};var f=O(e,o,{x:c,y:a}),p=A(e,o,o.components.camera.camera,f,r),h=p.x,w=p.y,z=p.z;if(u){var E=v.copy(l).multiply(d.getWorldQuaternion());g.set(n.x,n.y,n.z),g.applyQuaternion(E),E.multiply(s),y.setFromQuaternion(E,m),b.x=e.Math.radToDeg(y.x),b.y=e.Math.radToDeg(y.y),b.z=e.Math.radToDeg(y.z)}var D={x:h-g.x,y:w-g.y,z:z-g.z};t.emit(j,{nextPosition:D,nextRotation:b,clientX:c,clientY:a}),t.setAttribute("position",D),u&&t.setAttribute("rotation",b)}function a(e){var t=p(e.changedTouches,1),n=t[0];c(n)}function f(e){var t=e.detail;"position"!==t.name&&"rotation"!==t.name||h(t.oldData,t.newData)||c(x)}var d=(n.x,n.y,n.z,o.components.camera.camera),l=d.getWorldQuaternion().inverse(),s=t.object3D.getWorldQuaternion(),m=t.object3D.rotation.order,v=new e.Quaternion,y=t.object3D.rotation.clone(),g=new e.Vector3(n.x,n.y,n.z),x=i,b={x:e.Math.radToDeg(y.x),y:e.Math.radToDeg(y.y),z:e.Math.radToDeg(y.z)};return document.addEventListener("mousemove",c),document.addEventListener("touchmove",a),o.addEventListener("componentchanged",f),function(e){document.removeEventListener("mousemove",c),document.removeEventListener("touchmove",a),o.removeEventListener("componentchanged",f)}}function s(e){var t=arguments.length<=1||void 0===arguments[1]?b:arguments[1],n=e.THREE;e.registerComponent(t,{schema:{lockToLocalRotation:{default:!0}},init:function(){k(this,n,t,this.data.lockToLocalRotation)},update:function(){},remove:function(){V()},pause:function(){V()},play:function(){k(this,n,t,this.data.lockToLocalRotation)}})}var p=function(){function e(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done)&&(n.push(u.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&c.return&&c.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},v=o(function(e,t){function n(e){var t=[];for(var n in e)t.push(n);return t}t=e.exports="function"==typeof Object.keys?Object.keys:n,t.shim=n}),y=o(function(e,t){function n(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function o(e){return e&&"object"==("undefined"==typeof e?"undefined":m(e))&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();t=e.exports=r?n:o,t.supported=n,t.unsupported=o}),h=o(function(e){function t(e){return null===e||void 0===e}function n(e){return!(!e||"object"!==("undefined"==typeof e?"undefined":m(e))||"number"!=typeof e.length||"function"!=typeof e.copy||"function"!=typeof e.slice||e.length>0&&"number"!=typeof e[0])}function o(e,o,a){var f,d;if(t(e)||t(o))return!1;if(e.prototype!==o.prototype)return!1;if(u(e))return!!u(o)&&(e=r.call(e),o=r.call(o),c(e,o,a));if(n(e)){if(!n(o))return!1;if(e.length!==o.length)return!1;for(f=0;f<e.length;f++)if(e[f]!==o[f])return!1;return!0}try{var l=i(e),s=i(o)}catch(e){return!1}if(l.length!=s.length)return!1;for(l.sort(),s.sort(),f=l.length-1;f>=0;f--)if(l[f]!=s[f])return!1;for(f=l.length-1;f>=0;f--)if(d=l[f],!c(e[d],o[d],a))return!1;return("undefined"==typeof e?"undefined":m(e))===("undefined"==typeof o?"undefined":m(o))}var r=Array.prototype.slice,i=v,u=y,c=e.exports=function(e,t,n){return n||(n={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||"object"!=("undefined"==typeof e?"undefined":m(e))&&"object"!=("undefined"==typeof t?"undefined":m(t))?n.strict?e===t:e==t:o(e,t,n))}}),g=r,x=i,b="click-drag",w="dragstart",j="dragmove",z="dragend",E=300,D=function(){function e(e){return n=new e.Matrix4,!0}var t=!1,n=void 0;return{unproject:function(o,r,i){var u=i.components.camera.camera;return t=t||e(o),r.applyProjection(n.getInverse(u.projectionMatrix)),a(o,u,r)}}}(),T=D.unproject,L=function(){function e(e){return n=new e.Vector3,o=new e.Vector3,!0}var t=!1,n=void 0,o=void 0;return{screenCoordsToDirection:function(r,i,u){var a=u.x,d=u.y;t=t||e(r);var l=f(a,d,0,0,window.innerWidth,window.innerHeight),s=l.x,p=l.y;n.set(s,p,-1);var m=T(r,n,i);c(i,o);var v=m.sub(o).normalize(),y=v.x,h=v.y,g=v.z;return{x:y,y:h,z:g}}}}(),O=L.screenCoordsToDirection,M=function(){function e(e){return n=new e.Vector3,o=new e.Vector3,!0}var t=!1,n=void 0,o=void 0;return{directionToWorldCoords:function(r,i,u,a,f){var l=a.x,s=a.y,p=a.z;t=t||e(r),c(i,o),n.set(l,s,p);var m=d(u.getWorldDirection(),f,n),v=m.add(o),y=v.x,h=v.y,g=v.z;return{x:y,y:h,z:g}}}}(),A=M.directionToWorldCoords,S=function(){function e(e){return i=new e.Plane,n=new e.Vector3,o=new e.Vector3,r=new e.Raycaster,r.far=1/0,r.near=0,!0}var t=!1,n=void 0,o=void 0,r=void 0,i=void 0;return{selectItem:function(u,a,f,d,l){t=t||e(u);var s=O(u,f,{x:d,y:l}),p=s.x,m=s.y,v=s.z;c(f,n),o.set(p,m,v),r.set(n,o);var y=Array.from(f.sceneEl.querySelectorAll("["+a+"]")).map(function(e){return e.object3D}),h=!0,g=r.intersectObjects(y,h).filter(function(e){return!!e.object.el}).filter(function(e){return e.object.parent.visible})[0];if(!g)return{};var x=g.point,b=g.object;i.setFromNormalAndCoplanarPoint(f.components.camera.camera.getWorldDirection().clone().negate(),x.clone().sub(n));var w=i.constant,j=x.sub(b.getWorldPosition());return{depth:w,offset:j,element:b.el}}}}(),W=S.selectItem,C=function(){var e=void 0;return{initialize:function(t,n,o){function r(){for(var e=performance.now();D.length&&e-D[0].time>E;)D.shift()}function i(e){var t=e.detail.nextPosition;r(),D.push({position:Object.assign({},t),time:performance.now()})}function u(e){var r=e.clientX,u=e.clientY,c=W(t,n,v,r,u),a=c.depth,f=c.offset,d=c.element;d&&!function(){var e=l(t,d,f,v,a,{clientX:r,clientY:u},o);h=d,b={offset:{x:f.x,y:f.y,z:f.z},depth:a,clientX:r,clientY:u},d.emit(w,b),d.addEventListener(j,i),y=function(t){d.removeEventListener(j,i),e&&e(),e=null}}()}function c(e){if(D.length<2)return 0;var t=D.map(function(t){return{time:t.time,value:t.position[e]}}).reduce(function(e,t,n,o){if(0===n)return e;var r=t.value-o[n-1].value,i=(t.time-o[n-1].time)/1e3;return e.push([t.time,r/i]),e},[]),n=x(g(t));return n(D[D.length-1].time)}function a(e){var t=e.clientX,n=e.clientY;r();var o={x:c("x"),y:c("y"),z:c("z")};h.emit(z,Object.assign({},b,{clientX:t,clientY:n,velocity:o})),y&&y(),y=void 0}function f(e){var t=p(e.changedTouches,1),n=t[0];u(n)}function d(e){var t=p(e.changedTouches,1),n=t[0];a(n)}function s(){v=m.camera.el,document.addEventListener("mousedown",u),document.addEventListener("mouseup",a),document.addEventListener("touchstart",f),document.addEventListener("touchend",d),e=function(e){document.removeEventListener("mousedown",u),document.removeEventListener("mouseup",a),document.removeEventListener("touchstart",f),document.removeEventListener("touchend",d)}}var m=document.querySelector("a-scene"),v=void 0,y=void 0,h=void 0,b=void 0,D=[];m.hasLoaded?s():m.addEventListener("loaded",s)},tearDown:function(){e&&e(),e=void 0}}}(),P=C.initialize,X=C.tearDown,Y=function(){var e=[];return{didMount:function(t,n,o,r){0===e.length&&P(n,o,r),e.indexOf(t)===-1&&e.push(t)},didUnmount:function(t){var n=e.indexOf(t);n!==-1&&(e.splice(n,1),0===e.length&&X())}}}(),k=Y.didMount,V=Y.didUnmount;t.exports=s},{}]},{},[1])(1)});
//# sourceMappingURL=aframe-click-drag-component.min.js.map
